#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("@aws-cdk/cdk");
const mainLayer_1 = require("../lib/layer/mainLayer");
const nrta_1 = require("../lib/nrta");
const utils_1 = require("../lib/util/utils");
const app = new cdk.App();
let envname = app.node.getContext('envname');
if (!envname)
    envname = "";
let providedsuffix = app.node.getContext('suffix');
if (!providedsuffix)
    providedsuffix = "";
console.log('>>>> envname:', envname);
console.log('>>>> providedSuffix:', providedsuffix);
let initProps = new nrta_1.NRTAProps();
initProps.setApplicationName(envname);
initProps.setSuffix(providedsuffix);
utils_1.Utils.checkforExistingBuckets(initProps.getBucketNames())
    .then((listOfExistingBuckets) => {
    if (listOfExistingBuckets && listOfExistingBuckets.length > 0)
        console.log("The following buckets are NOT being created because already exists: ", listOfExistingBuckets);
    initProps.addParameter('existingbuckets', listOfExistingBuckets);
    new mainLayer_1.MainLayer(app, 'NRTA' + providedsuffix, initProps);
    app.run();
})
    .catch((errorList) => {
    console.log(errorList);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2RrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2RrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLG9DQUFxQztBQUVyQyxzREFBbUQ7QUFDbkQsc0NBQXdDO0FBQ3hDLDZDQUF5QztBQUV6QyxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUMxQixJQUFJLE9BQU8sR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM3QyxJQUFJLENBQUMsT0FBTztJQUFFLE9BQU8sR0FBRyxFQUFFLENBQUM7QUFDM0IsSUFBSSxjQUFjLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDbkQsSUFBSSxDQUFDLGNBQWM7SUFBRSxjQUFjLEdBQUMsRUFBRSxDQUFDO0FBQ3ZDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3JDLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEVBQUMsY0FBYyxDQUFDLENBQUM7QUFDbkQsSUFBSSxTQUFTLEdBQUcsSUFBSSxnQkFBUyxFQUFFLENBQUM7QUFDaEMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3RDLFNBQVMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7QUFFcEMsYUFBSyxDQUFDLHVCQUF1QixDQUFDLFNBQVMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztLQUNwRCxJQUFJLENBQUMsQ0FBQyxxQkFBcUIsRUFBRSxFQUFFO0lBQzVCLElBQUkscUJBQXFCLElBQUkscUJBQXFCLENBQUMsTUFBTSxHQUFHLENBQUM7UUFDekQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzRUFBc0UsRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO0lBQy9HLFNBQVMsQ0FBQyxZQUFZLENBQUMsaUJBQWlCLEVBQUUscUJBQXFCLENBQUMsQ0FBQztJQUNqRSxJQUFJLHFCQUFTLENBQUMsR0FBRyxFQUFFLE1BQU0sR0FBQyxjQUFjLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDckQsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBQ2xCLENBQUMsQ0FBQztLQUNHLEtBQUssQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFO0lBQ2pCLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDL0IsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIjIS91c3IvYmluL2VudiBub2RlXG5pbXBvcnQgY2RrID0gcmVxdWlyZSgnQGF3cy1jZGsvY2RrJyk7XG5cbmltcG9ydCB7IE1haW5MYXllciB9IGZyb20gJy4uL2xpYi9sYXllci9tYWluTGF5ZXInO1xuaW1wb3J0IHsgTlJUQVByb3BzIH0gZnJvbSAnLi4vbGliL25ydGEnO1xuaW1wb3J0IHsgVXRpbHMgfSBmcm9tICcuLi9saWIvdXRpbC91dGlscydcblxuY29uc3QgYXBwID0gbmV3IGNkay5BcHAoKTtcbmxldCBlbnZuYW1lID0gYXBwLm5vZGUuZ2V0Q29udGV4dCgnZW52bmFtZScpO1xuaWYgKCFlbnZuYW1lKSBlbnZuYW1lID0gXCJcIjtcbmxldCBwcm92aWRlZHN1ZmZpeCA9IGFwcC5ub2RlLmdldENvbnRleHQoJ3N1ZmZpeCcpO1xuaWYgKCFwcm92aWRlZHN1ZmZpeCkgcHJvdmlkZWRzdWZmaXg9XCJcIjtcbmNvbnNvbGUubG9nKCc+Pj4+IGVudm5hbWU6JyxlbnZuYW1lKTtcbmNvbnNvbGUubG9nKCc+Pj4+IHByb3ZpZGVkU3VmZml4OicscHJvdmlkZWRzdWZmaXgpO1xubGV0IGluaXRQcm9wcyA9IG5ldyBOUlRBUHJvcHMoKTtcbmluaXRQcm9wcy5zZXRBcHBsaWNhdGlvbk5hbWUoZW52bmFtZSk7XG5pbml0UHJvcHMuc2V0U3VmZml4KHByb3ZpZGVkc3VmZml4KTtcblxuVXRpbHMuY2hlY2tmb3JFeGlzdGluZ0J1Y2tldHMoaW5pdFByb3BzLmdldEJ1Y2tldE5hbWVzKCkpXG4gICAgLnRoZW4oKGxpc3RPZkV4aXN0aW5nQnVja2V0cykgPT4ge1xuICAgICAgICBpZiAobGlzdE9mRXhpc3RpbmdCdWNrZXRzICYmIGxpc3RPZkV4aXN0aW5nQnVja2V0cy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaGUgZm9sbG93aW5nIGJ1Y2tldHMgYXJlIE5PVCBiZWluZyBjcmVhdGVkIGJlY2F1c2UgYWxyZWFkeSBleGlzdHM6IFwiLCBsaXN0T2ZFeGlzdGluZ0J1Y2tldHMpO1xuICAgICAgICBpbml0UHJvcHMuYWRkUGFyYW1ldGVyKCdleGlzdGluZ2J1Y2tldHMnLCBsaXN0T2ZFeGlzdGluZ0J1Y2tldHMpO1xuICAgICAgICBuZXcgTWFpbkxheWVyKGFwcCwgJ05SVEEnK3Byb3ZpZGVkc3VmZml4LCBpbml0UHJvcHMpO1xuICAgICAgICBhcHAucnVuKCk7XG59KVxuICAgIC5jYXRjaCgoZXJyb3JMaXN0KSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yTGlzdCk7XG59KTsiXX0=