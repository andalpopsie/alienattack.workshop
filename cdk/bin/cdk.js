#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("@aws-cdk/cdk");
const mainLayer_1 = require("../lib/layer/mainLayer");
const nrta_1 = require("../lib/nrta");
const utils_1 = require("../lib/util/utils");
const app = new cdk.App();
let envname = app.node.getContext('envname');
if (!envname)
    envname = "";
let providedsuffix = app.node.getContext('suffix');
if (!providedsuffix)
    providedsuffix = "";
console.log('>>>> envname:', envname);
console.log('>>>> providedSuffix:', providedsuffix);
let initProps = new nrta_1.NRTAProps();
initProps.setApplicationName(envname);
initProps.setSuffix(providedsuffix);
utils_1.Utils.checkforExistingBuckets(initProps.getBucketNames())
    .then((listOfExistingBuckets) => {
    if (listOfExistingBuckets && listOfExistingBuckets.length > 0)
        console.log("The following buckets are NOT being created because already exists: ", listOfExistingBuckets);
    initProps.addParameter('existingbuckets', listOfExistingBuckets);
    new mainLayer_1.MainLayer(app, 'NRTA' + envname + providedsuffix, initProps);
    app.run();
})
    .catch((errorList) => {
    console.log(errorList);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2RrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2RrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLG9DQUFxQztBQUVyQyxzREFBbUQ7QUFDbkQsc0NBQXdDO0FBQ3hDLDZDQUF5QztBQUV6QyxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUMxQixJQUFJLE9BQU8sR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM3QyxJQUFJLENBQUMsT0FBTztJQUFFLE9BQU8sR0FBRyxFQUFFLENBQUM7QUFDM0IsSUFBSSxjQUFjLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDbkQsSUFBSSxDQUFDLGNBQWM7SUFBRSxjQUFjLEdBQUMsRUFBRSxDQUFDO0FBQ3ZDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxFQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3JDLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEVBQUMsY0FBYyxDQUFDLENBQUM7QUFDbkQsSUFBSSxTQUFTLEdBQUcsSUFBSSxnQkFBUyxFQUFFLENBQUM7QUFDaEMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3RDLFNBQVMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7QUFFcEMsYUFBSyxDQUFDLHVCQUF1QixDQUFDLFNBQVMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztLQUNwRCxJQUFJLENBQUMsQ0FBQyxxQkFBcUIsRUFBRSxFQUFFO0lBQzVCLElBQUkscUJBQXFCLElBQUkscUJBQXFCLENBQUMsTUFBTSxHQUFHLENBQUM7UUFDekQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzRUFBc0UsRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO0lBQy9HLFNBQVMsQ0FBQyxZQUFZLENBQUMsaUJBQWlCLEVBQUUscUJBQXFCLENBQUMsQ0FBQztJQUNqRSxJQUFJLHFCQUFTLENBQUMsR0FBRyxFQUFFLE1BQU0sR0FBQyxPQUFPLEdBQUMsY0FBYyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQzdELEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUNsQixDQUFDLENBQUM7S0FDRyxLQUFLLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRTtJQUNqQixPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQy9CLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiIyEvdXNyL2Jpbi9lbnYgbm9kZVxuaW1wb3J0IGNkayA9IHJlcXVpcmUoJ0Bhd3MtY2RrL2NkaycpO1xuXG5pbXBvcnQgeyBNYWluTGF5ZXIgfSBmcm9tICcuLi9saWIvbGF5ZXIvbWFpbkxheWVyJztcbmltcG9ydCB7IE5SVEFQcm9wcyB9IGZyb20gJy4uL2xpYi9ucnRhJztcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi4vbGliL3V0aWwvdXRpbHMnXG5cbmNvbnN0IGFwcCA9IG5ldyBjZGsuQXBwKCk7XG5sZXQgZW52bmFtZSA9IGFwcC5ub2RlLmdldENvbnRleHQoJ2Vudm5hbWUnKTtcbmlmICghZW52bmFtZSkgZW52bmFtZSA9IFwiXCI7XG5sZXQgcHJvdmlkZWRzdWZmaXggPSBhcHAubm9kZS5nZXRDb250ZXh0KCdzdWZmaXgnKTtcbmlmICghcHJvdmlkZWRzdWZmaXgpIHByb3ZpZGVkc3VmZml4PVwiXCI7XG5jb25zb2xlLmxvZygnPj4+PiBlbnZuYW1lOicsZW52bmFtZSk7XG5jb25zb2xlLmxvZygnPj4+PiBwcm92aWRlZFN1ZmZpeDonLHByb3ZpZGVkc3VmZml4KTtcbmxldCBpbml0UHJvcHMgPSBuZXcgTlJUQVByb3BzKCk7XG5pbml0UHJvcHMuc2V0QXBwbGljYXRpb25OYW1lKGVudm5hbWUpO1xuaW5pdFByb3BzLnNldFN1ZmZpeChwcm92aWRlZHN1ZmZpeCk7XG5cblV0aWxzLmNoZWNrZm9yRXhpc3RpbmdCdWNrZXRzKGluaXRQcm9wcy5nZXRCdWNrZXROYW1lcygpKVxuICAgIC50aGVuKChsaXN0T2ZFeGlzdGluZ0J1Y2tldHMpID0+IHtcbiAgICAgICAgaWYgKGxpc3RPZkV4aXN0aW5nQnVja2V0cyAmJiBsaXN0T2ZFeGlzdGluZ0J1Y2tldHMubGVuZ3RoID4gMClcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIGZvbGxvd2luZyBidWNrZXRzIGFyZSBOT1QgYmVpbmcgY3JlYXRlZCBiZWNhdXNlIGFscmVhZHkgZXhpc3RzOiBcIiwgbGlzdE9mRXhpc3RpbmdCdWNrZXRzKTtcbiAgICAgICAgaW5pdFByb3BzLmFkZFBhcmFtZXRlcignZXhpc3RpbmdidWNrZXRzJywgbGlzdE9mRXhpc3RpbmdCdWNrZXRzKTtcbiAgICAgICAgbmV3IE1haW5MYXllcihhcHAsICdOUlRBJytlbnZuYW1lK3Byb3ZpZGVkc3VmZml4LCBpbml0UHJvcHMpO1xuICAgICAgICBhcHAucnVuKCk7XG59KVxuICAgIC5jYXRjaCgoZXJyb3JMaXN0KSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yTGlzdCk7XG59KTsiXX0=